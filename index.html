<!doctype html>
<html lang="en">
  <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135113520-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135113520-1');
      </script>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="ChatBlocks by Instafluff: Build your own fully custom Twitch chat bot using blocks!">
    <meta name="keywords" content="instafluff, game, development, chat, bot, chatbot, twitch, stream, live, livestream, youtube, code, easy, web, dev, fun">
    <meta name="author" content="Instafluff">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="You don't need to know how to code to build a custom Twitch chat bot! I wanted to make it fun and SUPER-easy for anyone in our community to build a chat bot on Twitch regardless of programming knowledge or experience and created ChatBlocks, a web app that lets you use blocks to make sophisticated custom bots to run on any channel super-easily. It auto saves and loads your work and remembers the channel you put it in. You can even download and import blocks as files.">
    <meta name="twitter:image" content="https://www.instafluff.tv/assets/Banner.png">
    <meta name="twitter:creator" content="Instafluff">
    <meta name="twitter:title" content="ChatBlocks by Instafluff - Build your own fully custom Twitch chat bot using blocks!">
    <meta property="og:type" content="website">
    <meta property="og:description" content="You don't need to know how to code to build a custom Twitch chat bot! I wanted to make it fun and SUPER-easy for anyone in our community to build a chat bot on Twitch regardless of programming knowledge or experience and created ChatBlocks, a web app that lets you use blocks to make sophisticated custom bots to run on any channel super-easily. It auto saves and loads your work and remembers the channel you put it in. You can even download and import blocks as files.">
    <meta property="og:image" content="https://www.instafluff.tv/assets/Banner.png">
    <meta property="og:url" content="https://www.instafluff.tv/ChatBlocks">
    <meta property="og:title" content="ChatBlocks by Instafluff - Build your own fully custom Twitch chat bot using blocks!">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Fredoka+One|Open+Sans&display=swap" rel="stylesheet">

	<title>ChatBlocks - Twitch Chat Bots with Blocks!</title>
	<script src="web/dropzone.js"></script>
	<script src="web/blockly_compressed.js"></script>
	<script src="web/blocks_compressed.js"></script>
	<script src="web/javascript_compressed.js"></script>
	<script src="web/msg/js/en.js"></script>
	<script src="https://use.fontawesome.com/7ccab66fd7.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/comfytwitch@latest/web/comfytwitch.min.js"></script>
    <style>
    @font-face {
        font-family: OpenDyslexic;
        src: url( web/fonts/OpenDyslexic-Regular.woff );
    }
    html, body {
        font-family: "Fredoka One", "sans-serif";
        color: #ffffff;
        background-color: #333;
    }
	.translucent-purple-bg {
		background-color: rgba( 100, 65, 165, 0.5 );
		border-color: rgba( 100, 65, 165, 0.5 );
		color: #ccc;
	}
    .btn-purple-outline {
        background-color: #fff;
        border-color: #fff;
        color: #6441a5;
    }
    .btn-purple {
        background-color: #6441a5;
        border-color: #6441a5;
        color: #fff;
    }
    .btn-primary {
        background-color: #4C97FF;
        border-color: #4C97FF;
    }
    .btn-warning {
        background-color: #ffa600;
        border-color: #ffa600;
    }
    a, a:hover {
        color: #ffa600;
    }
    :root {
        --blue: #4C97FF;
        --primary: #4C97FF;
        --yellow: #ffa600;
        --warning: #ffa600;
    }
    .blocklyTreeLabel {
        font-family: "Fredoka One", "sans-serif";
    }
	.blocks-container {
		position: relative;
	}
	.blocks-blocker{
		position:absolute;
		left:0;
		top:0;
		width:100%;
		height:100%;
		display:block;
		z-index: 1000;
		background-color: rgba(255, 255, 255, 0.75);
	}
	.files {
		visibility: hidden;
		position: absolute;
		top: -9999px;
	}
    #login-group {
        position: absolute;
        top: 50%;
        left: 50%;
        -moz-transform: translateX(-50%) translateY(-50%);
        -webkit-transform: translateX(-50%) translateY(-50%);
        transform: translateX(-50%) translateY(-50%);
        z-index: 1002;
    }
	#channel-name {
		padding: .375rem 1.25rem;
	}
	.channel-name-quotes {
		position: relative;
	}
	.channel-name-quotes:before,
	.channel-name-quotes:after {
		content: '';
		display: none;
		background-repeat: no-repeat;
		background-position: center;
		background-size: contain;
		width: 12px;
		height: 12px;
		position: absolute;
		top: 8px;
		z-index: 10;
		opacity: 0.75;
	}
	.channel-name-quotes:before {
		background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC");
	}
	.channel-name-quotes:after {
		background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==");
	}
	@media (min-width: 576px) {
		.channel-name-quotes:before,
		.channel-name-quotes:after {
			display: block;
		}
		.channel-name-quotes:before {
			left: 2.875em;
		}
		.channel-name-quotes:after {
			right: 0.175em;
		}
	}
	@media (min-width: 768px) {
		.channel-name-quotes:after {
			right: 10.275em;
		}
	}
	</style>
  </head>
  <body class="container">
    <div id="profile-group" class="py-2 float-right" hidden><span><span id="username"></span> <img id="profile-image" class="rounded" src="" alt="Profile Image" height="38" width="38"></span> <button id="logout" class="btn btn-purple">Log Out</button></div>
    <h1>ChatBlocks by <a href="https://www.instafluff.tv" target="_blank">Instafluff</a></h1>
    <p>Build your own fully custom Twitch chat bot using blocks!</p>
	<div class="pb-2 row">
		<div class="col-6">
			<button id="save-code" class="btn btn-primary"><i class="fa fa-cloud-download"></i> Save Blocks</button> <button id="load-code" class="btn btn-warning"><i class="fa fa-cloud-upload"></i> Load Blocks</button>
		</div>
		<div class="col-6">
			<div class="input-group translucent channel-name-quotes">
			  <div class="input-group-prepend">
			    <span class="input-group-text btn-purple translucent-purple-bg" id="basic-addon1"><i class="fa fa-twitch"></i></span>
			  </div>
			  <input id="channel-name" type="text" class="form-control translucent-purple-bg" placeholder="Channel Name" aria-label="Channel" aria-describedby="basic-addon1">
			  <div class="input-group-append">
				  <button id="run-code" class="btn btn-success float-right" style="width: 10rem;"><i class="fa fa-play"></i> Run Blocks</button>
			  </div>
			</div>
		</div>
	</div>
	<div class="table table-striped files" id="previews"></div>
	<input type="file" id="blocks-file-input" accept=".cbs" hidden>
	<div class="blocks-container">
        <div id="login-group" hidden><button id="login" class="btn btn-purple center">Log In with <i class="fa fa-twitch"></i> Twitch</button></div>
		<div id="workspace"></div>
		<div id="blocklyDiv" style="height: 480px; width: 100%;"></div>
		<xml id="toolbox" style="display: none">
			<category name="TWITCH" colour="6441a5">
				<block type="twitch_oncommand"></block>
			    <block type="twitch_onchat"></block>
				<block type="twitch_user"></block>
				<block type="twitch_message"></block>
				<block type="twitch_reward_id"></block>
				<block type="twitch_is_broadcaster"></block>
				<block type="twitch_is_mod"></block>
				<block type="twitch_is_vip"></block>
				<block type="twitch_is_subscriber"></block>
				<block type="twitch_is_founder"></block>
				<block type="twitch_is_highlighted"></block>
				<block type="twitch_is_reward"></block>
				<block type="twitch_say"></block>
				<block type="twitch_whisper"></block>
			</category>
		    <category name="LOGIC" categorystyle="logic_category">
		      <block type="controls_if"></block>
		      <block type="logic_compare"></block>
		      <block type="logic_operation"></block>
		      <block type="logic_negate"></block>
		      <block type="logic_boolean"></block>
		      <block type="logic_null"></block>
		      <block type="logic_ternary"></block>
		    </category>
		    <category name="LOOPS" categorystyle="loop_category">
		      <block type="controls_repeat_ext">
		        <value name="TIMES">
		          <shadow type="math_number">
		            <field name="NUM">10</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="controls_whileUntil"></block>
		      <block type="controls_for">
		        <value name="FROM">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		        <value name="TO">
		          <shadow type="math_number">
		            <field name="NUM">10</field>
		          </shadow>
		        </value>
		        <value name="BY">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="controls_forEach"></block>
		      <block type="controls_flow_statements"></block>
		    </category>
		    <category name="MATH" categorystyle="math_category">
		      <block type="math_number">
		        <field name="NUM">123</field>
		      </block>
		      <block type="math_arithmetic">
		        <value name="A">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		        <value name="B">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_single">
		        <value name="NUM">
		          <shadow type="math_number">
		            <field name="NUM">9</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_trig">
		        <value name="NUM">
		          <shadow type="math_number">
		            <field name="NUM">45</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_constant"></block>
		      <block type="math_number_property">
		        <value name="NUMBER_TO_CHECK">
		          <shadow type="math_number">
		            <field name="NUM">0</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_round">
		        <value name="NUM">
		          <shadow type="math_number">
		            <field name="NUM">3.1</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_on_list"></block>
		      <block type="math_modulo">
		        <value name="DIVIDEND">
		          <shadow type="math_number">
		            <field name="NUM">64</field>
		          </shadow>
		        </value>
		        <value name="DIVISOR">
		          <shadow type="math_number">
		            <field name="NUM">10</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_constrain">
		        <value name="VALUE">
		          <shadow type="math_number">
		            <field name="NUM">50</field>
		          </shadow>
		        </value>
		        <value name="LOW">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		        <value name="HIGH">
		          <shadow type="math_number">
		            <field name="NUM">100</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_random_int">
		        <value name="FROM">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		        <value name="TO">
		          <shadow type="math_number">
		            <field name="NUM">100</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="math_random_float"></block>
		      <block type="math_atan2">
		        <value name="X">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		        <value name="Y">
		          <shadow type="math_number">
		            <field name="NUM">1</field>
		          </shadow>
		        </value>
		      </block>
		    </category>
		    <category name="TEXT" categorystyle="text_category">
		      <block type="text"></block>
		      <block type="text_join"></block>
		      <block type="text_append">
		        <value name="TEXT">
		          <shadow type="text"></shadow>
		        </value>
		      </block>
		      <block type="text_length">
		        <value name="VALUE">
		          <shadow type="text">
		            <field name="TEXT">abc</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="text_isEmpty">
		        <value name="VALUE">
		          <shadow type="text">
		            <field name="TEXT"></field>
		          </shadow>
		        </value>
		      </block>
		      <block type="text_indexOf">
		        <value name="VALUE">
		          <block type="variables_get">
		            <field name="VAR">{textVariable}</field>
		          </block>
		        </value>
		        <value name="FIND">
		          <shadow type="text">
		            <field name="TEXT">abc</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="text_charAt">
		        <value name="VALUE">
		          <block type="variables_get">
		            <field name="VAR">{textVariable}</field>
		          </block>
		        </value>
		      </block>
		      <block type="text_getSubstring">
		        <value name="STRING">
		          <block type="variables_get">
		            <field name="VAR">{textVariable}</field>
		          </block>
		        </value>
		      </block>
		      <block type="text_changeCase">
		        <value name="TEXT">
		          <shadow type="text">
		            <field name="TEXT">abc</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="text_trim">
		        <value name="TEXT">
		          <shadow type="text">
		            <field name="TEXT">abc</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="text_print">
		        <value name="TEXT">
		          <shadow type="text">
		            <field name="TEXT">abc</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="text_prompt_ext">
		        <value name="TEXT">
		          <shadow type="text">
		            <field name="TEXT">abc</field>
		          </shadow>
		        </value>
		      </block>
		    </category>
		    <category name="LISTS" categorystyle="list_category">
		      <block type="lists_create_with">
		        <mutation items="0"></mutation>
		      </block>
		      <block type="lists_create_with"></block>
		      <block type="lists_repeat">
		        <value name="NUM">
		          <shadow type="math_number">
		            <field name="NUM">5</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="lists_length"></block>
		      <block type="lists_isEmpty"></block>
		      <block type="lists_indexOf">
		        <value name="VALUE">
		          <block type="variables_get">
		            <field name="VAR">{listVariable}</field>
		          </block>
		        </value>
		      </block>
		      <block type="lists_getIndex">
		        <value name="VALUE">
		          <block type="variables_get">
		            <field name="VAR">{listVariable}</field>
		          </block>
		        </value>
		      </block>
		      <block type="lists_setIndex">
		        <value name="LIST">
		          <block type="variables_get">
		            <field name="VAR">{listVariable}</field>
		          </block>
		        </value>
		      </block>
		      <block type="lists_getSublist">
		        <value name="LIST">
		          <block type="variables_get">
		            <field name="VAR">{listVariable}</field>
		          </block>
		        </value>
		      </block>
		      <block type="lists_split">
		        <value name="DELIM">
		          <shadow type="text">
		            <field name="TEXT">,</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="lists_sort"></block>
		    </category>
		    <category name="COLOR" categorystyle="colour_category">
		      <block type="colour_picker"></block>
		      <block type="colour_random"></block>
		      <block type="colour_rgb">
		        <value name="RED">
		          <shadow type="math_number">
		            <field name="NUM">100</field>
		          </shadow>
		        </value>
		        <value name="GREEN">
		          <shadow type="math_number">
		            <field name="NUM">50</field>
		          </shadow>
		        </value>
		        <value name="BLUE">
		          <shadow type="math_number">
		            <field name="NUM">0</field>
		          </shadow>
		        </value>
		      </block>
		      <block type="colour_blend">
		        <value name="COLOUR1">
		          <shadow type="colour_picker">
		            <field name="COLOUR">#ff0000</field>
		          </shadow>
		        </value>
		        <value name="COLOUR2">
		          <shadow type="colour_picker">
		            <field name="COLOUR">#3333ff</field>
		          </shadow>
		        </value>
		        <value name="RATIO">
		          <shadow type="math_number">
		            <field name="NUM">0.5</field>
		          </shadow>
		        </value>
		      </block>
		    </category>
		    <sep></sep>
		    <category name="VARIABLES" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>
		    <category name="FUNCTIONS" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>
		</xml>
		<br/>
        <a href="https://developers.google.com/blockly" target="_blank"><img class="float-right" src="https://developers.google.com/blockly/images/logos/logo_built_on_knockout.png" height="28px" /></a>
	</div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
	<script src="web/chatblocks.js"></script>
    <script>
        const clientId = "xrxinjwucvs83rf1b6lxq758yslj3c";
        const baseUrl = window.location.origin + window.location.pathname;

        ComfyTwitch.Check()
        .then( async result => {
            if( result ) {
                // Logged In
                let user = await ComfyTwitch.GetUser( clientId, result.user_id );
                document.getElementById( "channel-name" ).value = window.localStorage.getItem( "channel" ) || result.login;
                document.getElementById( "username" ).innerText = user.display_name;
                document.getElementById( "profile-image" ).src = user.profile_image_url;
                document.querySelector( "#login-group" ).setAttribute( "hidden", true );
                document.querySelector( "#profile-group" ).removeAttribute( "hidden" );
                document.querySelector( "#logout" ).addEventListener( "click", function() {
                    ComfyTwitch.Logout();
                    window.location.reload();
                });
            }
            else {
                // Logged Out
                document.querySelector( "#profile-group" ).setAttribute( "hidden", true );
                document.querySelector( "#login-group" ).removeAttribute( "hidden" );
        		document.getElementById( "workspace" ).classList.add( "blocks-blocker" );
        		document.getElementById( "run-code" ).classList.add( "btn-secondary" );
        		document.getElementById( "run-code" ).setAttribute( "disabled", true );
				document.getElementById( "channel-name" ).value = "";
                document.querySelector( "#login" ).addEventListener( "click", function() {
                    ComfyTwitch.Login( clientId, baseUrl, [ "user:read:email", "chat:read", "chat:edit", "channel:moderate", "whispers:read", "whispers:edit" ] );
                });
            }
        });

		document.getElementById( "channel-name" ).onchange = function() {
			window.localStorage.setItem( "channel", document.getElementById( "channel-name" ).value);
		};
    </script>
	<div id="run-sandbox" hidden></div>
  </body>
</html>
